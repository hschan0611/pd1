{% extends "global/Page.html" %}
{% load otree static %}

{% block title %}
  Match {{ subsession.match_number }}, Round {{ subsession.round_in_match_number }} &#8211; Make Your Choice!
{% endblock %}

{% block styles %}
  <link rel="stylesheet" type="text/css" href="{% static 'global/matrix.css' %}" />
  <style>
    .rotate90 { display:inline-block; transform: rotate(-90deg); }
    .choice-actions { margin-top: 16px; display:flex; gap:12px; justify-content:center; }
  </style>
{% endblock %}

{% block content %}
  <div class="form-group required">

    <table class="table table-bordered text-center" style="width:auto; margin:auto">
      <tr>
        <th colspan="2" rowspan="2"></th>
        <th colspan="2">The Other Participant</th>
      </tr>
      <tr>
        <th>Action 1</th>
        <th>Action 2</th>
      </tr>

      {% if subsession.active_game == 1 %}
      <!-- Payoff table for Part 1 (same form as intro) -->
      <tr>
        <th rowspan="2"><span class="rotate90">You</span></th>
        <th>Action 1</th>
        <td>{{ Constants.both_cooperate_payoff_1 }}, {{ Constants.both_cooperate_payoff_1 }}</td>
        <td>{{ Constants.betrayed_payoff_1 }}, {{ Constants.betray_payoff_1 }}</td>
      </tr>
      <tr>
        <th>Action 2</th>
        <td>{{ Constants.betray_payoff_1 }}, {{ Constants.betrayed_payoff_1 }}</td>
        <td>{{ Constants.both_defect_payoff_1 }}, {{ Constants.both_defect_payoff_1 }}</td>
      </tr>

      {% else %}
      <!-- Payoff table for Part 2 (same form as intro) -->
      <tr>
        <th rowspan="2"><span class="rotate90">You</span></th>
        <th>Action 1</th>
        <td>{{ Constants.both_cooperate_payoff_2 }}, {{ Constants.both_cooperate_payoff_2 }}</td>
        <td>{{ Constants.betrayed_payoff_2 }}, {{ Constants.betray_payoff_2 }}</td>
      </tr>
      <tr>
        <th>Action 2</th>
        <td>{{ Constants.betray_payoff_2 }}, {{ Constants.betrayed_payoff_2 }}</td>
        <td>{{ Constants.both_defect_payoff_2 }}, {{ Constants.both_defect_payoff_2 }}</td>
      </tr>
      {% endif %}
    </table>

    <!-- Choices below the table, matching intro style -->
    <div class="choice-actions">
      <button name="decision" value="Action 1" class="btn btn-primary btn-large">I choose Action 1</button>
      <button name="decision" value="Action 2" class="btn btn-primary btn-large">I choose Action 2</button>
    </div>

  </div>
{% endblock %}
